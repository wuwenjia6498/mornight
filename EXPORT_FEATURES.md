# 导出和交互功能说明

## 🎯 功能概述

本次更新为右侧栏组件 `RightSidebar.tsx` 和中间栏组件 `MainContent.tsx` 添加了完整的导出和交互功能。

## ✨ 新增功能

### 1. 一键复制文案 📋

**位置**: 右侧栏每个文案标签页
**功能**: 
- 在每个文案类型（情感共鸣型、认知提升型、实用指导型）的标题旁边添加了复制按钮
- 点击复制按钮后，使用 `navigator.clipboard.writeText` 将对应文案复制到剪贴板
- 复制成功后显示Toast提示："xxx文案已复制到剪贴板！"
- 复制失败时显示错误提示

**使用方法**:
1. 选择任意内容卡片
2. 在右侧栏切换到想要的文案类型标签页
3. 点击标题右侧的复制图标
4. 文案已复制到剪贴板，可直接粘贴使用

### 2. 下载高清配图 📸

**位置**: 右侧栏配图选择区域
**功能**:
- 用户选择配图后，在确认按钮下方显示"下载高清图片"按钮
- 点击后自动下载选中的图片到本地
- 文件名格式：`日期_图片标题.jpg`
- 下载过程中显示Toast进度提示

**使用方法**:
1. 在右侧栏配图区域点击选择一张图片
2. 图片被选中后会显示蓝色边框和对勾标记
3. 点击下方的"下载高清图片"按钮
4. 图片自动下载到浏览器默认下载目录

### 3. 批量导出功能 📦

**位置**: 中间栏顶部右侧
**功能**:
- 使用 `jszip` 库将所有生成的内容和配图打包成ZIP文件
- 自动创建按日期分类的文件夹结构
- 每个日期文件夹包含：`content.txt`（文案内容）和 `image.jpg`（配图）
- 支持用户选择的配图，未选择时使用第一张作为默认

**文件结构**:
```
AI阅读内容_2024-01-22_14-30-45.zip
├── 2024-01-15/
│   ├── content.txt     # 包含所有三种类型的文案
│   └── image.jpg       # 用户选择的配图或默认第一张
├── 2024-01-16/
│   ├── content.txt
│   └── image.jpg
└── ...
```

**使用方法**:
1. 生成多个日期的内容
2. （可选）为每个内容选择配图
3. 点击中间栏顶部的"批量导出"按钮
4. 等待打包完成，ZIP文件自动下载

## 🛠️ 技术实现

### Toast 通知系统
- 使用 `sonner` 库提供优雅的通知提示
- 在 `layout.tsx` 中添加了 `<Toaster />` 组件
- 支持成功、错误、信息等多种提示类型

### 剪贴板 API
```typescript
await navigator.clipboard.writeText(text);
```
- 使用现代浏览器的剪贴板API
- 包含错误处理和降级方案

### 图片下载
```typescript
const response = await fetch(imageUrl);
const blob = await response.blob();
const url = window.URL.createObjectURL(blob);
// 创建下载链接并触发下载
```
- 通过Fetch API获取图片数据
- 创建Blob对象和下载链接
- 自动触发浏览器下载

### ZIP文件生成
```typescript
import JSZip from 'jszip';
const zip = new JSZip();
// 添加文件到压缩包
const zipBlob = await zip.generateAsync({ type: 'blob' });
```
- 使用JSZip库创建压缩文件
- 支持异步文件添加和生成
- 自动处理图片下载和文本编码

### 状态管理
- 新增 `selectedImages` 状态管理用户选择的配图
- 通过props在组件间传递状态和回调函数
- 保持组件间数据同步

## 🎮 交互体验

### 视觉反馈
- **复制按钮**: 悬停时显示工具提示
- **图片选择**: 选中状态有蓝色边框和对勾图标
- **下载按钮**: 只在选中图片时显示
- **批量导出**: 显示进度提示和完成通知

### 错误处理
- 网络错误时显示友好提示
- 剪贴板API不支持时提供降级方案
- 图片下载失败时不影响其他文件处理

### 性能优化
- 图片懒加载和错误处理
- ZIP文件生成时显示进度提示
- 大文件下载时的内存管理

## 🚀 使用演示

### 完整工作流程
1. **生成内容**: 在左侧栏选择日期并生成内容
2. **查看详情**: 点击中间栏的内容卡片
3. **复制文案**: 在右侧栏点击复制按钮获取文案
4. **选择配图**: 在右侧栏点击图片进行选择
5. **下载图片**: 点击下载按钮获取高清配图
6. **批量导出**: 点击批量导出获取完整ZIP包

### 调试功能
- 页面顶部的调试面板显示：
  - 测试数据数量
  - 当前选中内容
  - 已选择的配图数量
- 便于开发和测试时查看状态

## 📝 注意事项

1. **浏览器兼容性**: 剪贴板API需要HTTPS环境或localhost
2. **图片跨域**: 某些图片可能因CORS限制无法下载
3. **文件大小**: 批量导出时注意ZIP文件大小限制
4. **网络状况**: 图片下载速度取决于网络环境

## 🔄 后续优化

1. **进度条**: 为批量导出添加详细进度条
2. **格式选择**: 支持多种导出格式（PDF、Word等）
3. **云端存储**: 支持导出到云盘或在线存储
4. **模板定制**: 允许用户自定义导出模板
5. **批量操作**: 支持批量选择和操作多个内容 